<!DOCTYPE html>
<html lang="km">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<title>My Pink Wedding App</title>
<link rel="manifest" href="manifest.json">
<style>
  body {
    margin:0; font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen,Ubuntu,sans-serif;
    background: linear-gradient(135deg,#ffe6f0,#fff5fa);
    overflow:hidden; display:flex; flex-direction:column; height:100vh; position:relative;
  }

  /* Floating hearts background */
  .heart {
    position:absolute; width:18px; height:18px; background:pink; transform:rotate(45deg);
    border-radius:2px; opacity:0.7; animation: floatUp 10s linear infinite;
  }
  .heart::before, .heart::after {
    content:""; position:absolute; width:18px; height:18px; background:pink; border-radius:50%;
  }
  .heart::before { top:-9px; left:0; }
  .heart::after { left:-9px; top:0; }

  @keyframes floatUp {
    0% { transform:translateY(100vh) scale(0.5) rotate(45deg); opacity:0; }
    30% { opacity:1; }
    100% { transform:translateY(-10vh) scale(1.2) rotate(45deg); opacity:0; }
  }

  .app-header { background:#ff4da6; color:white; padding:15px; text-align:center; font-size:20px; font-weight:bold; border-bottom-left-radius:15px; border-bottom-right-radius:15px; box-shadow:0 2px 5px rgba(0,0,0,0.1); z-index:2; }

  .app-container { flex:1; padding:20px; overflow-y:auto; z-index:2; }

  .card { background:white; border-radius:20px; box-shadow:0 5px 15px rgba(0,0,0,0.1); padding:20px; margin-bottom:20px; transition: transform 0.2s ease; text-align:center; }
  .card:hover { transform:translateY(-5px); }
  .card h2 { margin:10px 0 5px 0; color:#ff4da6; }
  .card p { color:#444; line-height:1.5; }
  .card img { width:120px; height:120px; border-radius:50%; object-fit:cover; margin-bottom:10px; border:3px solid #ffb6c1; }

  .btn { display:inline-block; padding:12px 20px; background:#ff4da6; color:white; border:none; border-radius:12px; font-size:16px; cursor:pointer; overflow:hidden; position:relative; }
  .btn:hover { background:#e63e90; }

  .bottom-nav { display:flex; justify-content:space-around; background:#fff; padding:10px; border-top:1px solid #eee; box-shadow:0 -2px 5px rgba(0,0,0,0.05); z-index:2; }
  .nav-btn { text-align:center; font-size:14px; color:#555; cursor:pointer; transition:0.3s; }
  .nav-btn.active { color:#ff4da6; font-weight:bold; text-shadow:0 0 8px rgba(255,77,166,0.7); }

  #installBtn { position:fixed; bottom:80px; right:20px; z-index:1000; display:none; }

  .view { display:none; }
  .view.active { display:block; }

  iframe { width:100%; height:300px; border-radius:15px; border:0; }
</style>
</head>
<body>

<div class="app-header">💖 Wedding App</div>

<!-- Pages -->
<div class="app-container">
  <div id="home" class="view active">
    <div class="card">
      <h2>សូមស្វាគមន៍!</h2>
      <p>នេះជាគំរូ App UI PWA style iOS + Android។ ចុច💖 នៅលើ screen ដើម្បីបន្ថែម hearts effect។</p>
      <button class="btn">ចាប់ផ្តើម</button>
    </div>
    <div class="card">
      <h2>ព័ត៌មានថ្មីៗ</h2>
      <p>📰 អាចបន្ថែម News Feed, Notifications, និង Content ផ្សេងៗ។</p>
    </div>
  </div>

  <div id="map" class="view">
    <h2 style="text-align:center; color:#c71585;">ទីតាំងពិធីមង្គលការ</h2>
    <iframe id="mapFrame" src="https://www.google.com/maps?q=11.7951289,105.3758584&hl=km&z=16&output=embed" allowfullscreen="" loading="lazy"></iframe>
    <div style="text-align:center; margin-top:10px;">
      <button class="btn" onclick="copyMapLink()">📋 Copy Link</button>
      <button class="btn" onclick="shareMapLink()">🔗 Share Link</button>
    </div>
  </div>

  <div id="son" class="view">
    <div class="card">
      <img src="https://via.placeholder.com/120?text=Son1" alt="កូនប្រុស ១">
      <h2>កូនប្រុស ១</h2>
      <p>👦 គឺជាកូនប្រុសរបស់ពួកយើង</p>
    </div>
    <div class="card">
      <img src="https://via.placeholder.com/120?text=Son2" alt="កូនប្រុស ២">
      <h2>កូនប្រុស ២</h2>
      <p>👦 គឺជាកូនប្រុសរបស់ពួកយើង</p>
    </div>
  </div>
</div>

<div class="bottom-nav">
  <div class="nav-btn active" onclick="showPage('home', this)">🏠 Home</div>
  <div class="nav-btn" onclick="showPage('map', this)">🗺️ Map</div>
  <div class="nav-btn" onclick="showPage('son', this)">👦 កូនប្រុស</div>
</div>

<!-- Install button -->
<button id="installBtn" class="btn">📲 Install App</button>

<script>
  // Page navigation
  function showPage(pageId, btn){
    document.querySelectorAll('.view').forEach(v=>v.classList.remove('active'));
    document.getElementById(pageId).classList.add('active');
    document.querySelectorAll('.nav-btn').forEach(b=>b.classList.remove('active'));
    btn.classList.add('active');
  }

  const mapURL = "https://www.google.com/maps?q=11.7951289,105.3758584&hl=km&z=16";
  function copyMapLink() {
    navigator.clipboard.writeText(mapURL).then(()=>alert("Map link copied!"));
  }
  function shareMapLink() {
    if(navigator.share){
      navigator.share({title:"Wedding Map", text:"Check location:", url: mapURL});
    } else {
      alert("Your browser does not support share. Copy link instead.");
    }
  }

  // Floating hearts background
  for(let i=0;i<20;i++){
    let heart=document.createElement("div");
    heart.className="heart";
    heart.style.left=Math.random()*100+"vw";
    heart.style.animationDuration=(5+Math.random()*7)+"s";
    document.body.appendChild(heart);
  }

  // Tap hearts effect
  document.body.addEventListener("click", e=>{
    const heart=document.createElement("div");
    heart.className="heart";
    heart.style.left=e.clientX-9+"px";
    heart.style.top=e.clientY-9+"px";
    heart.style.animationDuration="1s";
    heart.style.opacity=1;
    document.body.appendChild(heart);
    setTimeout(()=>heart.remove(),1000);
  });

  // PWA Install
  let deferredPrompt;
  const installBtn = document.getElementById("installBtn");

  // Show button for desktop/mobile Chrome
  window.addEventListener('beforeinstallprompt', e=>{
    e.preventDefault();
    deferredPrompt = e;
    installBtn.style.display="block";
  });

  installBtn.addEventListener("click", async ()=>{
    if(deferredPrompt){
      deferredPrompt.prompt();
      const choice = await deferredPrompt.userChoice;
      console.log(choice.outcome);
      deferredPrompt = null;
      installBtn.style.display="none";
    } else {
      alert("On iOS Safari, tap Share → Add to Home Screen manually.");
    }
  });

  // TEMP: Always show button for testing iOS
  installBtn.style.display="block";
</script>
</body>
</html>
